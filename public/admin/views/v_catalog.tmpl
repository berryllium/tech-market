<div class="form col-md-12 col-12"></div>
  <form action="?page=catalog&act=add&id={{product.id}}" method="POST" enctype="multipart/form-data"
    class="flex columns">
    <input hidden name="id" value="{{product.id}}">
    <table>
      <tr>
        <td><label>Название</label></td>
        <td><input type="text" name="title" id="title" placeholder="Название" value="{{product.title}}" required></td>
      </tr>
      <tr>
        <td><label>Категория</label></td>
        <td><select name="id_cat" id="id_cat" required>
            {% for category in categories %}
            <option value="{{category.id}}" {{product.id_cat == category.id ? 'selected' : ''}}>{{category.name}}
            </option>
            {% endfor %}
          </select></td>
      </tr>
      <tr>
        <td colspan="2" class="text-center">Характеристики</td>
      </tr>
      {% for spec in specifications %}
      <tr>
        <td><input type="text" name="spec_prop[]" placeholder="Параметр" value="{{spec.prop}}" required></td>
        <td><input type="text" name="spec_val[]" placeholder="Значение" value="{{spec.value}}" required></td>
        <input type="hidden" name="id_spec[]" value="{{spec.id}}">
      </tr>
      {% endfor %}
      <tr id="add-tr">
        <td colspan="2" class="text-center"><button id="addspec" class="btn btn-warning m-auto">Добавить
            характеристику</button></td>
      </tr>

      <tr>
        <td>Новая цена</td>
        <td><input type="number" name="price_new" id="price_new" placeholder="Цена новая" value="{{product.price_new}}"
            required></td>
      </tr>

      <tr>
        <td>Старая цена</td>
        <td><input type="number" name="price_old" id="price_old" placeholder="Цена старая" value="{{product.price_old}}"
            required></td>
      </tr>

      <tr>
        <td>Описание</td>
        <td><textarea type="text" name="desc" id="decs" placeholder="Описание" required>{{product.detail}}</textarea>
        </td>
      </tr>

      <tr>
        <td>Особенности</td>
        <td><textarea type="text" name="features" id="features" placeholder="Особенности"
            required>{{product.features}}</textarea></td>
      </tr>

      {% for photo in photos %}
      <tr>
        <td><img src="../db/images/products/small/{{product.id}}/{{photo.src}}" alt="{{photo.title}}"></td>
        <td><a href="?page=single&act=del_img&id={{product.id}}&id_img={{photo.id}}">Удалить</a></td>
      </tr>
      {% endfor %}

      <tr>
        <td><input type="file" name="photo[]" id="photo" accept="image/jpeg,image/png,image/gif" multiple></td>
        <td><input type="submit" value="Добавить товар"></td>
      </tr>
    </table>
  </form>
</div>
{% if products %}
<table class="col-12">
  <tr>
    <th>Фото</th>
    <th>Название</th>
    <th>Категория</th>
    <th>Описание</th>
    <th>Цена</th>
    <th>Редактировать</th>
    <th>Удалить</th>
  </tr>
  {% for product in products %}
  <tr>
    <td> <img class="example-image" src="../db/images/products/small/{{product.id}}/{{product.photos[0].src}}"
        alt="{{product.title}}" /> </td>
    <td>{{product.title}}</td>
    <td>{{product.category}}</td>
    <td>{{product.desc}}</td>
    <td>{{product.price_new}}</td>
    <td> <a class="edit-link" href="?page=single&id={{product.id}}">Редактировать</a></td>
    <td> <a class="delete-link" href="?page=catalog&act=del&id={{product.id}}">&times;</a></td>

  </tr>
  {% endfor %}

</table>
{% else %}
<h3 class="col-12">добавьте товары</h3>';
{% endif %}

<script>
  let fields = `<tr><td><input type="text" name="spec_prop[]" placeholder="Параметр" value="{{spec.prop}}" required></td><td><input type="text" name="spec_val[]" placeholder="Значение" value="{{spec.value}}" required></td>
    <input type="hidden" name="id_spec[]" value="0"></tr>`;
  let specButton = document.querySelector('#addspec')
  let tr = document.querySelector('#add-tr')
  specButton.addEventListener('click', event => {
    event.preventDefault()
    tr.insertAdjacentHTML('beforebegin', fields);
  })
</script>

<style>
  form, table {
    width: 100%;
  }
  td:first-child {
    width: 30%;
  }
  input, textarea {
    display: block;
    width: 100% !important;
    margin: 0 !important;
  }
</style>